<!DOCTYPE html>
<html lang="ko" style="background:#0d1f16">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ë¡œê·¸ì¸ | ìŠ¤íƒ€ë²…ìŠ¤ ë¼ë””ì˜¤ì¹´í˜</title>
  <meta property="og:type" content="website" />
  <meta property="og:title" content="ìŠ¤íƒ€ë²…ìŠ¤ ë¼ë””ì˜¤ì¹´í˜" />
  <meta property="og:description" content="ëŒ€í•œë¯¼êµ­ ì‹¤ì‹œê°„ ë¼ë””ì˜¤ë¥¼ ë””ì§€í„¸ & ì•„ë‚ ë¡œê·¸ë¡œ ì¦ê¸°ì„¸ìš”. íƒ€ë¡œ, ì˜¤ëŠ˜ì˜ ìš´ì„¸, ê°™ì´ë“£ê¸°ê¹Œì§€!" />
  <meta property="og:image" content="https://og-image.jpg" />
  <meta property="og:url" content="./" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Inter:wght@400;500;600;700&family=Outfit:wght@400;600;800&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Inter:wght@400;500;600;700&family=Outfit:wght@400;600;800&display=swap"></noscript>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: #0d1f16;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
      font-family: 'Inter', sans-serif;
    }

    /* === Login / User Select === */
    .login-radio-body {
      width: 100%; max-width: 420px;
      background: linear-gradient(145deg, #0d1f16, #081510);
      border-radius: 28px;
      padding: 3px;
      border: 1px solid rgba(0,112,74,0.55);
      box-shadow:
        0 40px 80px rgba(0,0,0,0.5),
        0 0 30px rgba(0,112,74,0.18),
        0 0 60px rgba(0,112,74,0.08),
        inset 0 1px 0 rgba(255,255,255,0.08);
    }
    .login-radio-inner {
      background: linear-gradient(145deg, #0a1a10, #061008);
      border-radius: 25px;
      padding: 20px;
      position: relative;
    }
    .login-box {
      text-align: center;
    }
    .login-box.hidden { display: none; }
    .login-lcd {
      background: linear-gradient(180deg, #020e08, #041008);
      border-radius: 12px; padding: 16px;
      margin-bottom: 16px;
      border: 2px solid rgba(0,112,74,0.4);
      box-shadow: inset 0 2px 8px rgba(0,0,0,0.6), 0 0 12px rgba(0,112,74,0.1);
    }
    .login-lcd-title {
      font-family: 'Orbitron', monospace; font-size: 14px;
      color: #00c47a; letter-spacing: 4px; font-weight: 700;
      text-shadow: 0 0 10px rgba(0,196,122,0.6);
      margin-bottom: 6px;
    }
    .login-lcd-sub {
      font-family: 'Inter', sans-serif; font-size: 12px;
      color: #3a9a5a;
    }
    .login-footer {
      margin-top: 20px; padding-top: 16px;
      border-top: 1px solid rgba(102,187,255,0.15);
      text-align: center;
      font-family: 'Inter', sans-serif; font-size: 11px;
      color: rgba(0,196,122,0.4);
    }
    .footer-divider { margin: 0 8px; opacity: 0.5; }
    .footer-link {
      color: rgba(0,196,122,0.6); text-decoration: none;
      transition: color 0.2s;
    }
    .footer-link:hover { color: #00c47a; }

    .username-input {
      width: 100%; padding: 14px 20px; border-radius: 16px;
      border: 2px solid rgba(102,187,255,0.35);
      background: rgba(0,0,0,0.3); color: #fff;
      font-family: 'Inter', sans-serif; font-size: 16px;
      text-align: center; outline: none;
      transition: border-color 0.3s;
    }
    .username-input:focus { border-color: rgba(0,196,122,0.6); }
    .username-input::placeholder { color: rgba(255,255,255,0.3); }
    .birth-input-group {
      margin-top: 12px; padding: 12px; border-radius: 12px;
      background: rgba(0,0,0,0.15); border: 1px solid rgba(102,187,255,0.15);
    }
    .birth-label {
      font-family: 'Outfit', sans-serif; font-size: 11px; font-weight: 600;
      color: rgba(0,196,122,0.7); letter-spacing: 1px; margin-bottom: 8px; text-align: center;
    }
    .birth-guide {
      font-family: 'Inter', sans-serif; font-size: 10px; line-height: 1.5;
      color: rgba(255,255,255,0.85); text-align: center; margin-bottom: 10px;
    }
    .birth-row {
      display: flex; gap: 6px;
    }
    .birth-field {
      flex: 1; padding: 10px 4px; border-radius: 10px;
      border: 2px solid rgba(102,187,255,0.25);
      background: rgba(0,0,0,0.3); color: #fff;
      font-family: 'Inter', sans-serif; font-size: 15px;
      text-align: center; outline: none; transition: border-color 0.3s;
      -moz-appearance: textfield;
    }
    .birth-field::-webkit-outer-spin-button,
    .birth-field::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
    .birth-field:focus { border-color: rgba(0,196,122,0.6); }
    .birth-field::placeholder { color: rgba(255,255,255,0.3); font-size: 12px; }
    .birth-calendar-row {
      display: flex; justify-content: center; gap: 20px; margin-top: 8px;
    }
    .birth-radio-label {
      font-family: 'Inter', sans-serif; font-size: 13px; color: rgba(255,255,255,0.7);
      cursor: pointer; display: flex; align-items: center; gap: 4px;
    }
    .birth-radio-label input[type="radio"] {
      accent-color: #00c47a; width: 14px; height: 14px;
    }
    .password-input {
      width: 100%; padding: 14px 20px; border-radius: 16px;
      border: 2px solid rgba(102,187,255,0.35);
      background: rgba(0,0,0,0.3); color: #fff;
      font-family: 'Inter', sans-serif; font-size: 24px;
      text-align: center; outline: none; letter-spacing: 8px;
      transition: border-color 0.3s; margin-top: 12px;
    }
    .password-input:focus { border-color: rgba(0,196,122,0.6); }
    .password-input::placeholder { color: rgba(255,255,255,0.3); font-size: 14px; letter-spacing: 0; }
    .login-btn {
      margin-top: 20px; width: 100%; padding: 14px;
      background: linear-gradient(135deg, #66BBFF, #4499DD);
      border: none; border-radius: 16px;
      color: #041018; font-family: 'Outfit', sans-serif;
      font-size: 16px; font-weight: 700; letter-spacing: 2px;
      cursor: pointer; transition: all 0.3s;
    }
    .login-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(102,187,255,0.3);
    }
    .user-search-input {
      width: 100%; padding: 12px 16px; border-radius: 12px;
      border: 2px solid rgba(102,187,255,0.2);
      background: rgba(0,0,0,0.3); color: #fff;
      font-family: 'Inter', sans-serif; font-size: 14px;
      outline: none; transition: border-color 0.2s;
      margin-bottom: 12px;
    }
    .user-search-input:focus { border-color: rgba(0,196,122,0.5); }
    .user-search-input::placeholder { color: rgba(255,255,255,0.3); }
    .user-list {
      max-height: 200px; overflow-y: auto;
      margin-bottom: 16px;
    }
    .user-list::-webkit-scrollbar { width: 6px; }
    .user-list::-webkit-scrollbar-thumb { background: rgba(102,187,255,0.3); border-radius: 3px; }
    .user-item {
      padding: 14px 20px; margin: 8px 0;
      background: rgba(0,0,0,0.3); border-radius: 12px;
      border: 2px solid rgba(102,187,255,0.2);
      color: #fff; font-family: 'Inter', sans-serif; font-size: 15px;
      cursor: pointer; transition: all 0.2s;
      display: flex; align-items: center; gap: 10px;
    }
    .user-item:hover {
      border-color: rgba(0,196,122,0.5);
      background: rgba(102,187,255,0.1);
    }
    .user-item-icon { font-size: 20px; }
    .user-item-name { flex: 1; }
    .new-user-btn {
      width: 100%; padding: 12px;
      background: transparent; border: 2px dashed rgba(102,187,255,0.4);
      border-radius: 12px; color: rgba(0,196,122,0.7);
      font-family: 'Inter', sans-serif; font-size: 14px;
      cursor: pointer; transition: all 0.2s;
    }
    .new-user-btn:hover {
      border-color: rgba(0,196,122,0.7);
      color: #00c47a;
    }
    .back-btn {
      margin-top: 12px; width: 100%; padding: 10px;
      background: transparent; border: none;
      color: rgba(0,196,122,0.6); font-family: 'Inter', sans-serif;
      font-size: 13px; cursor: pointer; transition: color 0.2s;
    }
    .back-btn:hover { color: #00c47a; }
    .no-users {
      padding: 30px; text-align: center;
      color: rgba(0,196,122,0.5); font-size: 13px;
      font-family: 'Inter', sans-serif;
    }
    .user-badge {
      position: absolute; top: 10px; right: 10px;
      background: rgba(102,187,255,0.2); padding: 6px 12px;
      border-radius: 12px; font-size: 11px; color: #00c47a;
      font-family: 'Inter', sans-serif;
    }

    /* === Photo Speaker / Brand / Screw === */
    .photo-speaker {
      background: linear-gradient(180deg, #0e2520, #081a14);
      border-radius: 14px;
      padding: 10px 12px;
      margin-bottom: 16px;
      border: 2px solid rgba(0,112,74,0.5);
      position: relative;
      overflow: hidden;
      box-shadow: 0 0 10px rgba(0,112,74,0.1);
    }
    .photo-speaker::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background-image:
        radial-gradient(circle, rgba(0,112,74,0.12) 0.8px, transparent 0.8px),
        radial-gradient(circle, rgba(0,112,74,0.06) 0.8px, transparent 0.8px);
      background-size: 5px 5px, 5px 5px;
      background-position: 0 0, 2.5px 2.5px;
    }
    .photo-brand {
      text-align: center; margin-bottom: 16px; position: relative; z-index: 1;
    }
    .photo-brand-text {
      font-family: 'Outfit', sans-serif;
      font-size: 22px; font-weight: 800;
      letter-spacing: 3px;
      text-shadow: 0 -1px 0 rgba(0,0,0,0.6), 0 1px 0 rgba(255,255,255,0.08), 0 2px 4px rgba(0,0,0,0.4);
    }
    .photo-brand-clara {
      color: #00c47a;
      text-shadow: 0 0 12px rgba(0,196,122,0.5);
    }
    .photo-brand-cafe {
      color: #CBA258;
      text-shadow: 0 0 10px rgba(203,162,88,0.4);
    }
    .photo-brand-sub {
      display: block;
      font-family: 'Outfit', sans-serif;
      font-size: 12px; font-weight: 500;
      color: rgba(212,233,226,0.75);
      margin-top: 6px;
      letter-spacing: 1.5px;
    }
    .photo-brand::after {
      content: ''; display: block;
      width: 80px; height: 1px; margin: 12px auto 0;
      background: linear-gradient(90deg, transparent, rgba(0,196,122,0.6), transparent);
    }
    .landing-btn {
      display: inline-block;
      margin: 14px auto 10px;
      padding: 9px 22px;
      font-family: 'Orbitron', monospace;
      font-size: 11px; font-weight: 700;
      letter-spacing: 1.5px;
      color: #1a1a2e;
      background: linear-gradient(135deg, #d4a862, #b8944e);
      border-radius: 20px;
      text-decoration: none;
      box-shadow: 0 0 16px rgba(212,168,98,0.35);
      transition: transform 0.2s, box-shadow 0.3s;
      text-align: center;
    }
    .landing-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 0 24px rgba(212,168,98,0.55);
    }
    .photo-screw {
      position: absolute; width: 8px; height: 8px;
      background: linear-gradient(145deg, #CBA258, #A07830);
      border-radius: 50%; border: 1px solid rgba(203,162,88,0.3);
      z-index: 2;
      box-shadow: inset 0 1px 2px rgba(0,0,0,0.4), 0 0 4px rgba(203,162,88,0.3);
    }
    .photo-screw::after {
      content: ''; position: absolute; top: 50%; left: 50%;
      transform: translate(-50%,-50%) rotate(35deg);
      width: 4px; height: 0.5px; background: rgba(139,94,20,0.8);
    }
    .photo-screw-tl { top: 10px; left: 10px; }
    .photo-screw-tr { top: 10px; right: 10px; }
    .photo-screw-bl { bottom: 10px; left: 10px; }
    .photo-screw-br { bottom: 10px; right: 10px; }
  </style>
</head>
<body>
  <div style="display:flex;align-items:center;justify-content:center;min-height:100vh;padding:16px;">
    <div class="login-radio-body">
      <div class="login-radio-inner">
        <div class="photo-screw photo-screw-tl"></div>
        <div class="photo-screw photo-screw-tr"></div>
        <div class="photo-screw photo-screw-bl"></div>
        <div class="photo-screw photo-screw-br"></div>

        <div class="photo-speaker">
          <img src="starbucks-logo.png" alt="Starbucks" style="display:block;margin:0 auto;height:140px;object-fit:contain;background:#fff;border-radius:50%;padding:6px;filter:drop-shadow(0 0 12px rgba(0,196,122,0.5));">
        </div>

        <div class="photo-brand">
          <span class="photo-brand-text"><span class="photo-brand-clara">ìŠ¤íƒ€ë²…ìŠ¤</span> <span class="photo-brand-cafe">ë¼ë””ì˜¤ì¹´í˜</span></span>
          <span class="photo-brand-sub">ì»¤í”¼ í•œ ì”ê³¼ í•¨ê»˜ ë“£ëŠ” ë‚˜ë§Œì˜ ìŠ¤íƒ€ë²…ìŠ¤ ë¼ë””ì˜¤ â˜•</span>
        </div>

        <div style="text-align:center;"><a href="landing.html" class="landing-btn">&#9733; ë¼ë””ì˜¤ì¹´í˜ ì†Œê°œ ë³´ê¸°</a></div>

        <!-- ì‚¬ìš©ì ì„ íƒ í™”ë©´ -->
        <div class="login-box" id="userSelectBox">
          <div class="login-lcd">
            <div class="login-lcd-title">USER SELECT</div>
            <div class="login-lcd-sub">ì‚¬ìš©ìë¥¼ ì„ íƒ(ë˜ëŠ” ê²€ìƒ‰)í•˜ê±°ë‚˜, ìƒˆ ì‚¬ìš©ì ë“±ë¡í•˜ì„¸ìš”.</div>
          </div>
          <input type="text" id="userSearchInput" class="user-search-input" placeholder="" autocomplete="off" oninput="filterUsers()">
          <div class="user-list" id="userList"></div>
          <button class="new-user-btn" onclick="showNewUserForm()">+ ìƒˆ ì‚¬ìš©ì ë“±ë¡</button>
        </div>

        <!-- ìƒˆ ì‚¬ìš©ì ë“±ë¡ í™”ë©´ -->
        <div class="login-box hidden" id="newUserBox">
          <div class="login-lcd">
            <div class="login-lcd-title">NEW USER</div>
            <div class="login-lcd-sub">ë‹‰ë„¤ì„, ì´ë©”ì¼, ìƒë…„ì›”ì¼, ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”</div>
          </div>
          <input type="text" id="newUsernameInput" class="username-input" placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•˜ì„¸ìš”" maxlength="20">
          <input type="email" id="newEmailInput" class="username-input" placeholder="ì˜ˆ: hong@email.com" style="margin-top:8px;">
          <div class="birth-input-group">
            <div class="birth-label">ìƒë…„ì›”ì¼</div>
            <div class="birth-guide">ìƒë…„ì›”ì¼ì„ ì…ë ¥í•˜ë©´ ë§¤ì¼ ì˜¤ëŠ˜ì˜ ìš´ì„¸ë¥¼ ë°›ì•„ë³¼ ìˆ˜ ìˆìœ¼ë©°, ë‚´ ìƒì¼ê¹Œì§€ ë©°ì¹  ë‚¨ì•˜ëŠ”ì§€ ì•Œë¦¼ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.</div>
            <div class="birth-row">
              <input type="number" id="newBirthYear" class="birth-field" placeholder="ë…„" min="1920" max="2010" inputmode="numeric">
              <input type="number" id="newBirthMonth" class="birth-field" placeholder="ì›”" min="1" max="12" inputmode="numeric">
              <input type="number" id="newBirthDay" class="birth-field" placeholder="ì¼" min="1" max="31" inputmode="numeric">
            </div>
            <div class="birth-calendar-row">
              <label class="birth-radio-label"><input type="radio" name="birthCalendar" value="solar" checked> ì–‘ë ¥</label>
              <label class="birth-radio-label"><input type="radio" name="birthCalendar" value="lunar"> ìŒë ¥</label>
            </div>
          </div>
          <div class="birth-label" style="margin-top:10px;">ì„±ë³„</div>
          <div class="birth-calendar-row">
            <label class="birth-radio-label"><input type="radio" name="userGender" value="male" checked> ë‚¨ì</label>
            <label class="birth-radio-label"><input type="radio" name="userGender" value="female"> ì—¬ì</label>
          </div>
          <input type="password" id="newPasswordInput" class="password-input" placeholder="â—â—â—â—" maxlength="4" inputmode="numeric" pattern="[0-9]*" autocomplete="off">
          <button class="login-btn" onclick="registerNewUser()">ë“±ë¡í•˜ê¸°</button>
          <button class="back-btn" onclick="showUserSelect()">â† ëŒì•„ê°€ê¸°</button>
        </div>

        <!-- í‘¸í„° -->
        <div class="login-footer">
          <span>Â© 2026 ìŠ¤íƒ€ë²…ìŠ¤ ë¼ë””ì˜¤ì¹´í˜</span>
          <span class="footer-divider">|</span>
          <a href="landing.html" class="footer-link" style="color: #d4a862; font-weight: 700;">ì†Œê°œ</a>
          <span class="footer-divider">|</span>
          <a href="manual.html" class="footer-link" style="color: #ff69b4; font-weight: 700;">ì‚¬ìš©ë²•</a>
          <span class="footer-divider">|</span>
          <a href="admin.html" class="footer-link">ê´€ë¦¬ì</a>
          <span class="footer-divider">|</span>
          <a href="about.html" class="footer-link">íŒ€ìŠ¤</a>
        </div>
      </div>
    </div>
  </div>

  <script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    // === Supabase ì„¤ì • ===
    var SUPABASE_URL = 'https://haxcktfnuudlqciyljtp.supabase.co';
    var SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImhheGNrdGZudXVkbHFjaXlsanRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjkzMDUwNDAsImV4cCI6MjA4NDg4MTA0MH0.suN7BeaHx3MjaNlMDQa0940P-rMl2XPyk4ksoQEU3YM';
    var supabase;
    var BUCKET_NAME = 'photo-albums';

    // Supabase init
    (function initSupabase() {
      function tryInit() {
        if (window.supabase && window.supabase.createClient) {
          supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY, {
            global: { fetch: function(url, opts) { opts = opts || {}; opts.cache = 'no-store'; return fetch(url, opts); } }
          });
        } else {
          setTimeout(tryInit, 100);
        }
      }
      tryInit();
    })();

    // === ì‚¬ìš©ì ë¡œê·¸ì¸ ===
    var cachedUsers = null;

    function getUsers() {
      if (cachedUsers) return cachedUsers;
      return {};
    }

    async function loadUsersFromCloud() {
      try {
        var { data, error } = await supabase.storage.from(BUCKET_NAME).download('_system/users.json');
        if (data) {
          var text = await data.text();
          var users = JSON.parse(text);
          cachedUsers = users;
          return users;
        }
      } catch(e) { console.log('í´ë¼ìš°ë“œ ì‚¬ìš©ì ë¡œë“œ ì‹¤íŒ¨:', e); }
      cachedUsers = {};
      return {};
    }

    async function saveUsersToCloud(users) {
      try {
        var blob = new Blob([JSON.stringify(users)], { type: 'application/json' });
        await supabase.storage.from(BUCKET_NAME).upload('_system/users.json', blob, { upsert: true });
      } catch(e) { console.log('í´ë¼ìš°ë“œ ì‚¬ìš©ì ì €ì¥ ì‹¤íŒ¨:', e); }
    }

    function renderUserList(filter) {
      var users = getUsers();
      var userNames = Object.keys(users);
      var listEl = document.getElementById('userList');

      if (filter && filter.trim()) {
        var keyword = filter.trim().toLowerCase();
        userNames = userNames.filter(function(name) {
          return name.toLowerCase().indexOf(keyword) !== -1;
        });
      }

      if (userNames.length === 0) {
        var msg = filter ? 'ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤' : 'ë“±ë¡ëœ ì‚¬ìš©ìê°€ ì—†ìŠµë‹ˆë‹¤';
        listEl.innerHTML = '<div class="no-users">' + msg + '</div>';
      } else {
        listEl.innerHTML = '';
        userNames.forEach(function(name) {
          var item = document.createElement('div');
          item.className = 'user-item';
          item.innerHTML = '<span class="user-item-icon">ğŸ‘¤</span><span class="user-item-name">' + name + '</span>';
          item.onclick = function() { selectUser(name); };
          listEl.appendChild(item);
        });
      }
    }

    function filterUsers() {
      var searchInput = document.getElementById('userSearchInput');
      renderUserList(searchInput.value);
    }

    function selectUser(name) {
      window.location.href = 'password.html?user=' + encodeURIComponent(name);
    }

    function showUserSelect() {
      document.getElementById('userSelectBox').classList.remove('hidden');
      document.getElementById('newUserBox').classList.add('hidden');
      document.getElementById('userSearchInput').value = '';
      renderUserList();
    }

    function showNewUserForm() {
      document.getElementById('userSelectBox').classList.add('hidden');
      document.getElementById('newUserBox').classList.remove('hidden');
      document.getElementById('newUsernameInput').value = '';
      document.getElementById('newEmailInput').value = '';
      document.getElementById('newPasswordInput').value = '';
      document.getElementById('newUsernameInput').focus();
    }

    async function registerNewUser() {
      var nameInput = document.getElementById('newUsernameInput');
      var emailInput = document.getElementById('newEmailInput');
      var passInput = document.getElementById('newPasswordInput');
      var birthYearInput = document.getElementById('newBirthYear');
      var birthMonthInput = document.getElementById('newBirthMonth');
      var birthDayInput = document.getElementById('newBirthDay');
      var name = nameInput.value.trim();
      var email = emailInput.value.trim();
      var pass = passInput.value.trim();
      var birthYear = parseInt(birthYearInput.value);
      var birthMonth = parseInt(birthMonthInput.value);
      var birthDay = parseInt(birthDayInput.value);
      var birthCalendar = document.querySelector('input[name="birthCalendar"]:checked').value;
      var gender = document.querySelector('input[name="userGender"]:checked').value;

      if (!name) {
        alert('ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        nameInput.focus();
        return;
      }
      if (!email) {
        alert('ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        emailInput.focus();
        return;
      }
      if (!birthYear || birthYear < 1920 || birthYear > 2010) {
        alert('ì¶œìƒì—°ë„ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”. (1920~2010)');
        birthYearInput.focus();
        return;
      }
      if (!birthMonth || birthMonth < 1 || birthMonth > 12) {
        alert('ì¶œìƒì›”ì„ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”. (1~12)');
        birthMonthInput.focus();
        return;
      }
      if (!birthDay || birthDay < 1 || birthDay > 31) {
        alert('ì¶œìƒì¼ì„ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”. (1~31)');
        birthDayInput.focus();
        return;
      }
      if (!pass || pass.length !== 4 || !/^\d{4}$/.test(pass)) {
        alert('ë¹„ë°€ë²ˆí˜¸ 4ìë¦¬ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        passInput.focus();
        return;
      }

      var users = getUsers();
      if (users[name]) {
        alert('ì´ë¯¸ ë“±ë¡ëœ ì‚¬ìš©ìì…ë‹ˆë‹¤.');
        return;
      }

      users[name] = { password: pass, email: email, birthYear: birthYear, birthMonth: birthMonth, birthDay: birthDay, birthCalendar: birthCalendar, gender: gender };
      cachedUsers = users;
      await saveUsersToCloud(users);

      localStorage.setItem('radioUsername', name);
      window.location.href = 'photo.html';
    }

    // DOMContentLoaded
    document.addEventListener('DOMContentLoaded', function() {
      var newPassInput = document.getElementById('newPasswordInput');

      if (newPassInput) {
        newPassInput.addEventListener('input', function() {
          this.value = this.value.replace(/[^0-9]/g, '');
        });
        newPassInput.addEventListener('keypress', function(e) {
          if (e.key === 'Enter') registerNewUser();
        });
      }

      // ì˜¤ë˜ëœ localStorage ì‚¬ìš©ì ìºì‹œ ì •ë¦¬
      try { localStorage.removeItem('radioUsers'); } catch(e) {}

      // Supabase ì´ˆê¸°í™” ëŒ€ê¸° í›„ ì‚¬ìš©ì ëª©ë¡ ë¡œë“œ
      var waitInit = setInterval(function() {
        if (supabase) {
          clearInterval(waitInit);
          loadUsersFromCloud().then(function() {
            renderUserList();
          });
        }
      }, 100);
    });
  </script>
</body>
</html>
